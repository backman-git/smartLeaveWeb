// Generated by CoffeeScript 1.12.3
(function() {
  define(function() {
    var securityQR;
    return securityQR = (function() {
      function securityQR() {
        var downloadingImage, image;
        this.pID = 0;
        this.tagID = -10;
        image = document.getElementById('SQR');
        downloadingImage = new Image();
        downloadingImage.onload = function() {
          return image.src = this.src;
        };
        $.get("/security/QRTag", (function(_this) {
          return function(data, status) {
            var QRImgPath;
            console.log(data);
            QRImgPath = data["QRImgPath"];
            downloadingImage.src = "../QR/" + QRImgPath;
            _this.tagID = data["tagID"];
          };
        })(this));
        return;
      }

      securityQR.prototype.on = function(fn) {
        return this.trigerFn = fn;
      };

      securityQR.prototype.setData = function(data) {
        return this.trigerFn(data);
      };

      securityQR.prototype.getInfo = function() {
        return $.get("/security/getAccount", {
          tagID: "" + this.tagID
        }, (function(_this) {
          return function(data, status) {
            console.log(data);
            if (data["status"] !== false) {
              clearInterval(_this.pID);
              return _this.setData(data);
            }
          };
        })(this));
      };

      securityQR.prototype.implantQR = function() {
        this.pID = setInterval(((function(_this) {
          return function() {
            return _this.getInfo();
          };
        })(this)), 100);
      };

      return securityQR;

    })();
  });

}).call(this);
